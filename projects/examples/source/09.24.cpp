/////////////////////////////////////////////////////////////////////////////////

// chapter : Memory Management

/////////////////////////////////////////////////////////////////////////////////

// section : Dynamic Memory

/////////////////////////////////////////////////////////////////////////////////

// content : Functions operator new and operator delete Microbenchmarking

/////////////////////////////////////////////////////////////////////////////////

#include <new>

/////////////////////////////////////////////////////////////////////////////////

#include <benchmark/benchmark.h>

/////////////////////////////////////////////////////////////////////////////////

void test(benchmark::State & state)
{
    for (auto element : state)
    {
        operator delete(operator new(state.range(0)), state.range(0));
    }
}

/////////////////////////////////////////////////////////////////////////////////

BENCHMARK(test)->RangeMultiplier(2)->Range(1'024 * 1'024, 1'024 * 1'024 * 1'024);

/////////////////////////////////////////////////////////////////////////////////

int main()
{
    benchmark::RunSpecifiedBenchmarks();
}

/////////////////////////////////////////////////////////////////////////////////